# Migration `20200902160947-create_roles_table`

This migration has been generated by Vasco Martins at 9/2/2020, 5:09:47 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `meet`.`Course` (
`id` int  NOT NULL  AUTO_INCREMENT,
`name` varchar(191)  NOT NULL ,
`slug` varchar(191)  NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `meet`.`Role` (
`id` int  NOT NULL  AUTO_INCREMENT,
`name` varchar(191)  NOT NULL ,
`slug` varchar(191)  NOT NULL ,
`priority` int  NOT NULL DEFAULT 0,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `meet`.`User` (
`id` int  NOT NULL  AUTO_INCREMENT,
`createdAt` datetime(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`email` varchar(191)  NOT NULL ,
`birthDate` datetime(3)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`gender` varchar(191)  NOT NULL ,
`courseId` int  ,
`roleId` int  NOT NULL ,
`password` varchar(191)  NOT NULL ,
UNIQUE Index `User.email_unique`(`email`),
Index `courseId`(`courseId`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `meet`.`User` ADD FOREIGN KEY (`courseId`) REFERENCES `meet`.`Course`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `meet`.`User` ADD FOREIGN KEY (`roleId`) REFERENCES `meet`.`Role`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200902111133-add_nullable_constrains_to_users_table..20200902160947-create_roles_table
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 model Course {
   id   Int    @default(autoincrement()) @id
@@ -13,17 +13,27 @@
   slug String
   User User[]
 }
+model Role {
+  id       Int    @default(autoincrement()) @id
+  name     String
+  slug     String
+  priority Int    @default(0)
+  User     User[]
+}
+
 model User {
   id        Int      @default(autoincrement()) @id
   createdAt DateTime @default(now())
   email     String   @unique
   birthDate DateTime
   name      String
   gender    String
   courseId  Int?
+  roleId    Int
   password  String
   Course    Course?  @relation(fields: [courseId], references: [id])
+  Role      Role     @relation(fields: [roleId], references: [id])
   @@index([courseId], name: "courseId")
 }
```


